<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>post</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="/cssPost/styles.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Responsive navbar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="#!">Movie_revieW</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="#">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="#!">About</a></li>
            <li class="nav-item"><a class="nav-link" href="#!">Contant</a></li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#"
                >login/logout</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- Page content-->
    <div class="container mt-5">
      <div class="row">
        <div class="col-lg-8">
          <!-- Post content-->
          <article>
            <!-- Post header-->
            <header class="mb-4">
              <!-- Post title-->

              <h1 class="fw-bolder mb-1"><%=home[0].title%></h1>

              <!-- Post meta content-->
              <div class="text-muted fst-italic mb-2" id="wrdate"></div>
              <!-- Post categories-->

     

            </header>
            <!-- Preview image figure-->
            <figure class="mb-4">
              <img
                class="img-fluid rounded"
                src="https://dummyimage.com/900x400/ced4da/6c757d.jpg"
                alt="..."
              />
            </figure>
            <!-- Post content-->
          </article>

          <!-- Comments section-->
          <section class="mb-5 parent">
            <div class="card bg-light">
              <div class="card-body" >
                <!-- Comment form-->
                <form class="mb-4">
                  <textarea
                    class="form-control"
                    rows="3"
                    id ='content'
                  ></textarea>
                  <a
                class="badge bg-secondary text-decoration-none link-light"
                id="btnAdd"
                >Post</a>
                <a class="badge bg-secondary text-decoration-none link-light btnAp"
                 href="#!"> Update</a>
                    <a class="badge bg-secondary text-decoration-none link-light btnDel"
                    href="#!">Delete</a>
                </form>
                <!-- Comment with nested comments-->
                <%for (let i = 0; i < post.length; i++) {%>
                <div class="d-flex mb-4 one" >
                  <!-- Parent comment-->

                <!-- Single comment-->
                <div class="d-flex">
                  <div class="flex-shrink-0">
                    <img
                      class="rounded-circle"
                      src="https://dummyimage.com/50x50/ced4da/6c757d.jpg"
                      alt="..."
                    />
                  </div>
                  <div class="ms-3">
                    <div class="fw-bold"><%=post[i].nickname%></div>
                    <%=post[i].content%>
                    <a class="badge bg-secondary text-decoration-none link-light btnone"
                    href="#!" data-id="<%=post[i].no%>">One</a>
                  </div>
                </div>
              </div>
              <%}%>
            </div>
          </section>
        </div>
        <!-- Side widgets-->
        <div class="col-lg-4">
          <!-- Search widget-->
          <div class="card mb-4">
            <div class="card-header">Search</div>
            <div class="card-body">
              <div class="input-group">
                <input
                  class="form-control"
                  type="text"
                  placeholder="Enter search term..."
                  aria-label="Enter search term..."
                  aria-describedby="button-search"
                />
                <button
                  class="btn btn-primary"
                  id="button-search"
                  type="button"
                >
                  Go!
                </button>
              </div>
            </div>
          </div>
          <!-- Categories widget-->
          <div class="card mb-4">
            <div class="card-header">Categories</div>
            <div class="card-body">
              <div class="row">
                <div class="col-sm-6">
                  <ul class="list-unstyled mb-0">
                    <li><a href="#!">Web Design</a></li>
                    <li><a href="#!">HTML</a></li>
                    <li><a href="#!">Freebies</a></li>
                  </ul>
                </div>
                <div class="col-sm-6">
                  <ul class="list-unstyled mb-0">
                    <li><a href="#!">JavaScript</a></li>
                    <li><a href="#!">CSS</a></li>
                    <li><a href="#!">Tutorials</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <!-- Side widget-->
          <div class="card mb-4">
            <div class="card-header">Side Widget</div>
            <div class="card-body">
              You can put anything you want inside of these side widgets. They
              are easy to use, and feature the Bootstrap 5 card component!
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer-->
    <footer class="py-5 bg-dark">
      <div class="container">
        <p class="m-0 text-center text-white">
          Copyright &copy; Your Website 2022
        </p>
      </div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="/jsPost/scripts.js"></script>
    <script>
      //등록패치
      btnAdd.addEventListener("click", function (ev) {
        ev.preventDefault();
        let data = {
          content: content.value,
          home_no: "<%=home[0].no%>",
          nickname: "aa",
        };
        fetch("/post", {
          method: "post",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        })
          .then((res) => res.json())
          .then((res) => {
            alert("등록완료");
          });
      });
      //단건조회 패치
      document.querySelector(".parent").addEventListener("click",function(ev){
         ev.preventDefault();
         let no = ev.target.getAttribute("data-id")
         ev.target.nodeName = "BUTTON"
        let data = {
          no : no};
        fetch(`/post/one/${no}`)
 .then((res) => res.json())
.then((res)=>{content.value=res.content})


        })    
    </script>
  </body>
</html>